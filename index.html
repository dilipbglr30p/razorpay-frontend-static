<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://checkout.razorpay.com; connect-src 'self' https://api.razorpay.com https://lumberjack-cx.razorpay.com; font-src 'self' data:; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; frame-src https://api.razorpay.com;">
  <title>Razorpay Payment Demo</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
</head>
<body>
  <h2>Pay ₹500</h2>
  <button id="payBtn">Pay Now</button>

  <script>
    document.getElementById("payBtn").onclick = async function () {
      // Step 1: Create order from backend
      const order = await fetch("http://localhost:5000/create-order", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ amount: 500, user_id: "demo" }),
      }).then(res => res.json());

      // Step 2: Initialize Razorpay Checkout
      const options = {
        key: "rzp_test_RUiY79QHMVinT8", // Replace with your test key id
        amount: order.amount,
        currency: "INR",
        name: "GroupBuy / CaaS Demo",
        description: "Test Payment",
        order_id: order.id,
        handler: async function (response) {
          // Step 3: Verify payment in backend
          await fetch("http://localhost:5000/verify-payment", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(response),
          });
          alert("✅ Payment successful!");
        },
        theme: { color: "#528FF0" },
      };

      const rzp1 = new Razorpay(options);
      rzp1.open();
    };
  </script>
</body>
</html>
